<!DOCTYPE html>
<html>
<head>
    <title>CoinDCX HFT Signal Tracker</title>
    <style>
        body { font-family: Arial; padding: 20px; background: #f7f7f7; }
        button { padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 5px; }
        #results { margin-top: 20px; white-space: pre-wrap; background: #fff; padding: 10px; border: 1px solid #ccc; }
    </style>
</head>
<body>
    <h2>ðŸ“ˆ CoinDCX HFT Trading Dashboard (Frontend Signal)</h2>
    <button onclick="simulateAndSend('BTCUSDT')">Scan BTCUSDT</button>
    <button onclick="simulateAndSend('ETHUSDT')">Scan ETHUSDT</button>
    <button onclick="simulateAndSend('DOGEUSDT')">Scan DOGEUSDT</button>

    <div id="results"></div>

    <script>
        function simulateAndSend(pair) {
            // Simulate 3 candles with random data
            const candles = [];
            let base = Math.random() * 100 + 1000;
            for (let i = 0; i < 3; i++) {
                const open = base + Math.random() * 10;
                const close = open + Math.random() * 10;
                const high = Math.max(open, close) + Math.random() * 5;
                const low = Math.min(open, close) - Math.random() * 5;
                const volume = Math.floor(Math.random() * 1000 + 500);
                candles.push({ open, close, high, low, volume });
                base = close;
            }

            const p1 = parseFloat(candles[2].close);
            const p2 = parseFloat(candles[1].close);
            const p3 = parseFloat(candles[0].close);
            const v1 = candles[2].volume;
            const v2 = candles[1].volume;
            const v3 = candles[0].volume;

            const avgVol = (v2 + v3) / 2;
            const bodySize = Math.abs(candles[2].close - candles[2].open);
            const wickSize = Math.abs(candles[2].high - candles[2].low);

            let signal = null;

            if (p1 > p2 && p2 > p3 && v1 > 1.2 * avgVol && bodySize > 0.3 * wickSize) {
                signal = "buy";
            } else if (p1 < p2 && p2 < p3 && bodySize > 0.7 * wickSize) {
                signal = "sell";
            }

            if (!signal) {
                document.getElementById("results").innerText = "No trade signal for " + pair;
                return;
            }

            fetch("/api/" + signal, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ pair, candles })
            }).then(res => res.json()).then(data => {
                document.getElementById("results").innerText = JSON.stringify(data, null, 2);
            });
        }
    </script>
</body>
</html>