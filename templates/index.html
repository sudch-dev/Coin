<!DOCTYPE html>
<html>
<head>
    <title>CoinDCX EMA(5,10) Spot Auto-Trader</title>
    <style>
        body { background: #f6fbfd; font-family: Arial; }
        .box { background: #fff; max-width: 500px; margin: 40px auto; padding: 28px 22px; border-radius: 10px; box-shadow: 0 6px 30px #ccd; }
        .log { background: #f6f6f6; font-size: 14px; padding: 8px; border-radius: 6px; margin-bottom: 7px; }
        .row { margin-bottom: 11px; }
        .btn { background: #3c8efc; color: #fff; border: none; border-radius: 5px; padding: 6px 24px; margin-right: 7px; font-size: 15px; cursor: pointer; }
        .btn:disabled { background: #ddd; color: #aaa; }
        .pnl { color: green; font-weight: bold; }
        .stat { font-size: 15px; }
    </style>
</head>
<body>
    <div class="box">
        <h3>CoinDCX EMA(5,10) Spot Auto-Trader</h3>
        <div class="row">
            <button id="start" class="btn">START</button>
            <button id="stop" class="btn">STOP</button>
        </div>
        <div class="row stat"><b>Status:</b> <span id="status"></span></div>
        <div class="row"><b>USDT Balance:</b> <span id="usdt"></span></div>
        <div class="row"><b>Last 1hr P&L:</b> <span id="pnl" class="pnl"></span></div>
        <div class="row"><b>Recent Trades</b>
            <div id="trades" class="log"></div>
        </div>
        <div class="row"><b>Recent Scans</b>
            <div id="scans" class="log"></div>
        </div>
    </div>
    <script>
        function loadStatus() {
            fetch("/status").then(r=>r.json()).then(d=>{
                document.getElementById("status").textContent = d.status;
                document.getElementById("usdt").textContent = d.usdt;
                document.getElementById("pnl").textContent = d.pnl;
                document.getElementById("trades").innerHTML = (d.trades.length ? d.trades.map(t=>`${t.ts} ${t.symbol} ${t.side} ${t.qty} @${t.entry}`).join("<br>") : "No trades yet.");
                document.getElementById("scans").innerHTML = (d.scans.length ? d.scans.join("<br>") : "No scans yet.");
            });
        }
        document.getElementById("start").onclick = function(){
            fetch("/start", {method:"POST"}).then(()=>setTimeout(loadStatus, 800));
        }
        document.getElementById("stop").onclick = function(){
            fetch("/stop", {method:"POST"}).then(()=>setTimeout(loadStatus, 800));
        }
        setInterval(loadStatus, 2000);
        loadStatus();
    </script>
</body>
</html>
