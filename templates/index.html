<!DOCTYPE html>
<html>
<head>
  <title> Dashboard</title>
  <style>
    body { font-family: Arial; background:#f4f4f4; }
    .card { background:white; margin:10px; padding:10px; border-radius:6px; box-shadow:0 2px 4px rgba(0,0,0,.1);}
    pre { background:#eee; padding:6px; height:200px; overflow:auto;}
    button { margin:5px; padding:8px 12px; }
    .row{display:flex; justify-content:space-between;}
  </style>
</head>
<body>
  <h1>Trading Bot Dashboard</h1>
  <button onclick="start()">Start</button>
  <button onclick="stop()">Stop</button>

  <div class="card"><h2>Status</h2><div id="status">—</div><div id="last">—</div></div>
  <div class="card"><h2>Keep-Alive</h2>
    <div class="row"><span>Enabled</span><span id="ka-enabled">—</span></div>
    <div class="row"><span>Interval</span><span id="ka-interval">—</span></div>
    <div class="row"><span>Last Ping Age</span><span id="ka-last-age">—</span></div>
    <div class="row"><span>Next Due</span><span id="ka-next-due">—</span></div>
    <div class="row"><span>Base URL</span><span id="ka-base-url">—</span></div>
  </div>
  <div class="card"><h2>Orders</h2><pre id="orders"></pre></div>
  <div class="card"><h2>Trades</h2><pre id="trades"></pre></div>
  <div class="card"><h2>Scan Logs</h2><pre id="logs"></pre></div>

<script>
async function refresh(){
  let r=await fetch("/status"); let d=await r.json();
  document.getElementById("status").textContent="Status: "+d.status;
  document.getElementById("last").textContent="Last: "+d.last;
  // keepalive
  document.getElementById("ka-enabled").textContent=d.keepalive.enabled;
  document.getElementById("ka-interval").textContent=d.keepalive.interval_sec+"s";
  document.getElementById("ka-last-age").textContent=d.keepalive.last_ping_age_sec;
  document.getElementById("ka-next-due").textContent=d.keepalive.next_due_sec;
  document.getElementById("ka-base-url").textContent=d.keepalive.app_base_url;
  // orders/trades/logs
  document.getElementById("orders").textContent=JSON.stringify(d.order_book,null,2);
  document.getElementById("trades").textContent=d.trades.join("\n");
  document.getElementById("logs").textContent=d.scans.join("\n");
}
function start(){fetch("/start",{method:"POST"})}
function stop(){fetch("/stop",{method:"POST"})}
setInterval(refresh,2000);
</script>
</body>
</html>
